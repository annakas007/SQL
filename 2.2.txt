1. Вывести название, жанр и цену тех книг, количество которых больше 8, в отсортированном по убыванию цены виде.

select title, name_genre, price
from book b join genre g
on b.genre_id = g.genre_id
   
where amount > 8
order by price desc

2. Необходимо в каждом городе провести выставку книг каждого автора в течение 2020 года. 
Дату проведения выставки выбрать случайным образом. Создать запрос, который выведет город, автора и дату 
проведения выставки. Последний столбец назвать Дата. Информацию вывести, отсортировав сначала 
в алфавитном порядке по названиям городов, а потом по убыванию дат проведения выставок.

select name_city, name_author, (DATE_ADD('2020-01-01', INTERVAL FLOOR(RAND() * 365) DAY)) as Дата
from city, author
order by name_city, Дата desc

3. Вывести информацию о книгах (жанр, книга, автор), относящихся к жанру, включающему слово «роман» в
 отсортированном по названиям книг виде.

select name_genre, title, name_author
from book
join genre on genre.genre_id = book.genre_id
join author on author.author_id = book.author_id
where name_genre like 'Роман'
ord 

4.Посчитать количество экземпляров  книг каждого автора из таблицы author. 
 Вывести тех авторов,  количество книг которых меньше 10, в отсортированном по возрастанию количества виде.
 Последний столбец назвать Количество.

select name_author, sum(amount) as Количество
from author left join book
on book.author_id = author.author_id
group by name_author
having Количество < 10 or Количество is null
order by Количество 

5. Вывести в алфавитном порядке всех авторов, которые пишут только в одном жанре.
 Поскольку у нас в таблицах так занесены данные, что у каждого автора книги только в одном жанре,  
для этого запроса внесем изменения в таблицу book. Пусть у нас  книга Есенина «Черный человек» относится к 
жанру «Роман», а книга Булгакова «Белая гвардия» к «Приключениям» (эти изменения в таблицы уже внесены).

select name_author 
from
(select name_author, count(distinct name_genre) as g
from book b join author a on b.author_id = a.author_id
            join genre g on b.genre_id = g.genre_id
group by  name_author
 having g = 1)  v 

6.Вывести информацию о книгах (название книги, фамилию и инициалы автора, название жанра, цену 
и количество экземпляров книг), написанных в самых популярных жанрах, в отсортированном в алфавитном порядке
 по названию книг виде. Самым популярным считать жанр, общее количество экземпляров книг которого на складе
 максимально.

select title, name_author, name_genre, price, amount name_genre
from book b
    join author a on b.author_id = a.author_id
    join genre g on b.genre_id = g.genre_id
    join
        (select genre_id, sum(amount) sa
            from book 
             group by genre_id
             having sa = 
            (select sum(amount) sa
                from book 
                group by genre_id
                order by sa desc
                limit 1)) maxamount
     on maxamount.genre_id = b.genre_id
order by title